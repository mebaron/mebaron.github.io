---
title: k8s apiserver证书添加新地址
date: 2023-03-28 21:01:05
tags:
- k8s
- ca
categories:
- 技术
type: "tags"
---

# k8s apiserver证书添加新地址

## 1.环境基础

| 集群版本 |     安装环境      |
| :------: | :---------------: |
| v1.26.3  | kubeadm安装的集群 |

<!--more-->

## 2.查看当前证书中的可信地址

```bash
# k8s证书目录： /etc/kubernetes/pki

openssl x509 -in apiserver.crt -noout -text
```

## 3.给证书添加新地址

### 3.1.修改kubeadm-config.yaml ,在certSANs中添加要加入的地址

```yaml
apiServer:
  certSANs:
  - xx.xx.xx.xx
```

### 3.2.删除k8s证书目录中的apiserver.crt 、apiserver.key

```bash
# k8s证书目录： /etc/kubernetes/pki

rm -f apiserver.*
```

### 3.3.根据kubeadm配置文件生成新的证书

```bash
kubeadm init phase certs apiserver --config ./kubeadm-config.yaml
```

### 3.4.查看新生成证书中的可信地址

```bash
# k8s证书目录： /etc/kubernetes/pki

openssl x509 -in apiserver.crt -noout -text
```

